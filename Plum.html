<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>جدول الخطة العسكرية 24/7</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f5f7fa;
      padding: 20px;
      color: #2c3e50;
    }
    h2, h3 {
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      margin-bottom: 20px;
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: center;
      font-size: 14px;
    }
    th {
      background: #34495e;
      color: white;
    }
    input[type="number"] {
      width: 80px;
      padding: 5px;
      text-align: center;
    }
    button {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin: 3px;
    }
    .submit-btn {
      background-color: #27ae60;
      color: white;
    }
    .save-btn {
      background-color: #2980b9;
      color: white;
    }
    .clear-btn {
      background-color: #c0392b;
      color: white;
    }
    #results, #history {
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 15px;
      margin-top: 20px;
    }
    #results p, #history p {
      margin: 8px 0;
    }
  </style>
</head>
<body>

<h2>📋 جدول الخطة العسكرية 24/7</h2>

<table>
  <thead>
    <tr>
      <th>الجولة</th>
      <th>الرهان</th>
      <th>الربح</th>
      <th>الخسارة</th>
      <th>تسجيل</th>
    </tr>
  </thead>
  <tbody id="table-body"></tbody>
</table>

<div id="results">
  <h3>📌 نتائج الجولات</h3>
  <div id="round-results"></div>
  <p id="total-profit"></p>
  <p id="total-loss"></p>
  <p id="net-profit"></p>
  <p id="win-count"></p>
  <p id="loss-count"></p>
  <button class="save-btn" onclick="saveToJSON()">💾 حفظ النتائج</button>
  <button class="clear-btn" onclick="clearPageResults()">🧹 مسح الصفحة فقط</button>
</div>

<div id="history">
  <h3>📚 أرشيف الأرباح اليومية</h3>
  <div id="daily-history"></div>
</div>

<script>
const rounds = 30;
let logs = [];
let savedDays = [];

function loadHistory() {
  const saved = localStorage.getItem("history");
  if (saved) {
    savedDays = JSON.parse(saved);
    renderHistory();
  }
}

function renderHistory() {
  const container = document.getElementById("daily-history");
  container.innerHTML = "";
  savedDays.forEach((day, index) => {
    const entry = document.createElement("p");
    entry.textContent = `📆 يوم ${index + 1}: الربح: ${day.totalProfit}$ | الخسارة: ${day.totalLoss}$ | الصافي: ${day.netProfit}$ | ✅ ${day.winCount} | ❌ ${day.lossCount}`;
    container.appendChild(entry);
  });
}

function generateTable() {
  const body = document.getElementById("table-body");
  for (let i = 1; i <= rounds; i++) {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${i}</td>
      <td>$${(1 + (i % 5)).toFixed(2)}</td>
      <td><input type="number" id="profit_${i}" step="0.01"></td>
      <td><input type="number" id="loss_${i}" step="0.01"></td>
      <td><button class="submit-btn" onclick="submitRound(${i})">📤 تسجيل</button></td>
    `;
    body.appendChild(row);
  }
}

function submitRound(i) {
  const profit = parseFloat(document.getElementById(`profit_${i}`).value) || 0;
  const loss = parseFloat(document.getElementById(`loss_${i}`).value) || 0;
  logs.push({ round: i, profit, loss });

  const resultsDiv = document.getElementById("round-results");
  const p = document.createElement("p");
  p.textContent = `رقم الجولة ${i} ➤ الربح: ${profit}$ | الخسارة: ${loss}$`;
  resultsDiv.appendChild(p);

  updateSummary();
}

function updateSummary() {
  let totalProfit = 0, totalLoss = 0, winCount = 0, lossCount = 0;
  logs.forEach(log => {
    totalProfit += log.profit;
    totalLoss += log.loss;
    if (log.profit > log.loss) winCount++;
    else if (log.loss > log.profit) lossCount++;
  });

  document.getElementById("total-profit").textContent = `📈 إجمالي الأرباح: ${totalProfit.toFixed(2)}$`;
  document.getElementById("total-loss").textContent = `📉 إجمالي الخسائر: ${totalLoss.toFixed(2)}$`;
  document.getElementById("net-profit").textContent = `💰 الربح الصافي: ${(totalProfit - totalLoss).toFixed(2)}$`;
  document.getElementById("win-count").textContent = `✅ الجولات الرابحة: ${winCount}`;
  document.getElementById("loss-count").textContent = `❌ الجولات الخاسرة: ${lossCount}`;
}

function saveToJSON() {
  let totalProfit = 0, totalLoss = 0, winCount = 0, lossCount = 0;
  logs.forEach(log => {
    totalProfit += log.profit;
    totalLoss += log.loss;
    if (log.profit > log.loss) winCount++;
    else if (log.loss > log.profit) lossCount++;
  });

  const netProfit = totalProfit - totalLoss;

  savedDays.push({
    totalProfit: totalProfit.toFixed(2),
    totalLoss: totalLoss.toFixed(2),
    netProfit: netProfit.toFixed(2),
    winCount,
    lossCount
  });

  localStorage.setItem("history", JSON.stringify(savedDays));
  renderHistory();
}

function clearPageResults() {
  logs = [];
  document.getElementById("round-results").innerHTML = "";
  document.getElementById("total-profit").textContent = "";
  document.getElementById("total-loss").textContent = "";
  document.getElementById("net-profit").textContent = "";
  document.getElementById("win-count").textContent = "";
  document.getElementById("loss-count").textContent = "";
  for (let i = 1; i <= rounds; i++) {
    document.getElementById(`profit_${i}`).value = "";
    document.getElementById(`loss_${i}`).value = "";
  }
}

generateTable();
loadHistory();
</script>

</body>
</html>
